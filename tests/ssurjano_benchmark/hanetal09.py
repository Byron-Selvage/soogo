import numpy as np
def hanetal09(xx, b=np.array([1, 0, -1, 6, 4, 5, -6, -6, -6])):
    ##########################################################################
    #HAN ET AL. (2009) FUNCTION
    ############################
    
    x = xx[0]
    z = xx[1]
    
    b01 = b[0]
    b11 = b[3]
    b21 = b[6]
    b02 = b[1]
    b12 = b[4]
    b22 = b[7]
    b03 = b[2]
    b13 = b[5]
    b23 = b[8]
    
    if z == 1:
        y = b01 + b11*x + b21*x**2
    elif z ==2:
        y = b02 + b12*x + b22*x**2
    else:
        y = b03 + b13*x + b23*x**2
    
    return(y)