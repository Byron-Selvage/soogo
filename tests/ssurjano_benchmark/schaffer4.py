import numpy as np
def schaffer4(xx):
    ##########################################################################
    # SCHAFFER FUNCTION N. 4
    ############################################################
    
    x1, x2 = xx[:2]
    
    fact1 = (np.cos(np.sin(abs(x1**2-x2**2)))**2 - 0.5)
    fact2 = (1 + 0.001*(x1**2+x2**2))**2
    
    y = 0.5 + fact1/fact2
    
    return y